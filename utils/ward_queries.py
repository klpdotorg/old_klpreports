corporator_queries = {
'corporator_gend_sch':"select tssc.sex, sum(tssc.numstu) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=1 group by tssc.sex",
'corporator_gend_presch':"select tssc.sex, sum(tssc.numstu) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=2 and tssc.cat='Anganwadi' group by tssc.sex",
'corporator_mt_sch':"select tssc.mt, sum(tssc.numstu) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=1 group by tssc.mt;",
'corporator_mt_presch':"select tssc.mt, sum(tssc.numstu) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=2 and tssc.cat='Anganwadi' group by tssc.mt;",
'corporator_schcount':"select count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and tse.heirarchy=1;",
'corporator_preschcount':"select count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and tse.heirarchy=2 and tssc.sid=tse.sid and tssc.cat='Anganwadi';",
'corporator_const_details':"select elec_comm_code, const_ward_name , current_elected_rep, const_ward_type, neighbours,current_elected_party from tb_electedrep_master where const_ward_type='MLA Constituency' and id=%s;",
'corporator_moi_sch':"select distinct tssc.moi, count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=1 group by tssc.moi;",
#'corporator_moi_presch':"select distinct tssc.moi, count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=2 and tssc.cat='Anganwadi' group by tssc.moi;",
'corporator_cat_sch':"select distinct tssc.cat, count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=1 group by tssc.cat;",
'corporator_cat_presch':"select distinct tssc.cat, count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=2 and tssc.cat='Anganwadi' group by tssc.cat;",
'corporator_neighbour_sch':"select distinct tem.const_ward_name,count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse, tb_electedrep_master tem where tse.ward_id = tem.id and tse.sid=tssc.sid and tem.elec_comm_code in %s and tse.heirarchy=1 group by tem.const_ward_name;",
'corporator_neighbour_presch':"select distinct tem.const_ward_name,count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse, tb_electedrep_master tem where tse.ward_id = tem.id and tse.sid=tssc.sid and tem.elec_comm_code in %s and tse.heirarchy=2 and tssc.cat='Anganwadi' group by tem.const_ward_name;",
'corporator_neighbour_gendsch':"select distinct tem.const_ward_name, tssc.sex, sum(tssc.numstu) from tb_school_stu_counts tssc, tb_school_electedrep tse,tb_electedrep_master tem where tse.sid=tssc.sid and tse.ward_id = tem.id and tem.elec_comm_code in %s and heirarchy=1 group by tem.const_ward_name,tssc.sex",
'corporator_neighbour_gendpresch':"select distinct tem.const_ward_name, tssc.sex, sum(tssc.numstu) from tb_school_stu_counts tssc, tb_school_electedrep tse,tb_electedrep_master tem where tse.sid=tssc.sid and tse.ward_id = tem.id and tem.elec_comm_code in %s and heirarchy=2 and tssc.cat='Anganwadi' group by tem.const_ward_name,tssc.sex",
'corporator_enrol_sch':"select distinct tssc.cat, sum(tssc.numstu)/count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=1 group by tssc.cat;",
'corporator_enrol_presch':"select distinct tssc.cat, sum(tssc.numstu)/count(distinct tssc.sid) from tb_school_stu_counts tssc, tb_school_electedrep tse where tse.sid=tssc.sid and tse.ward_id=%s and heirarchy=2 and tssc.cat='Anganwadi' group by tssc.cat;",
'corporator_tlmgrant_sch':"select tem.const_ward_name, vpd.grant_type, vpd.grant_amount, vpd.grant_amount* sum(vdf.teacher_count) as total_grant from tb_electedrep_master tem,tb_school_electedrep tse, vw_paisa_data vpd, vw_school_dise vsd, vw_dise_facility vdf where tem.id=tse.ward_id and tse.sid=vsd.sid and vdf.dise_id=vsd.dise_code and vpd.criteria='teacher_count' and tse.ward_id=%s group by tem.const_ward_name, vpd.grant_type, vpd.grant_amount;",
'corporator_mtncgrant_sch':"select tem.const_ward_name, vpd2.grant_type, CASE WHEN mvdf.operator='gt' THEN 'With more than 3 classrooms ' ELSE 'With 3 classrooms or fewer ' END as classroom_count, count(distinct tse.sid), vpd2.grant_amount * count(distinct tse.sid) as total_grant from (select vdf.dise_id as dise_id, CASE WHEN vdf.classroom_count <= CAST (vpd.factor AS INT) THEN 'lt' ELSE 'gt' END as operator from vw_paisa_data vpd, vw_dise_facility vdf where vpd.criteria='classroom_count') AS mvdf, tb_electedrep_master tem, tb_school_electedrep tse, vw_school_dise vsd, vw_paisa_data vpd2 where tem.id=tse.ward_id and tse.sid = vsd.sid and mvdf.dise_id=vsd.dise_code and mvdf.operator = vpd2.operator and tse.ward_id=%s group by tem.const_ward_name, vpd2.grant_type, mvdf.operator, vpd2.grant_amount order by tem.const_ward_name;",
'corporator_annualgrant_sch':"select tem.const_ward_name, vsd.cat, vpd.grant_type, count(distinct tse.sid), vpd.grant_amount * count(distinct tse.sid) as total_grant from tb_electedrep_master tem, tb_school_electedrep tse, vw_school_dise vsd, vw_paisa_data vpd where tem.id=tse.ward_id and tse.sid=vsd.sid and vpd.criteria='school_cat' and vpd.factor = vsd.cat::text and tse.ward_id=%s group by tem.const_ward_name, vsd.cat,vpd.grant_type,vpd.grant_amount order by tem.const_ward_name, vsd.cat;",
'corporator_neighbor_annual':"select tem.const_ward_name, vsd.cat, vpd.grant_type, vpd.grant_amount * count(distinct tse.sid) as total_grant from tb_electedrep_master tem, tb_school_electedrep tse, vw_school_dise vsd, vw_paisa_data vpd where tem.id=tse.ward_id and tse.sid=vsd.sid and vpd.criteria='school_cat' and vpd.factor = vsd.cat::text and tem.elec_comm_code in %s group by tem.const_ward_name, vsd.cat,vpd.grant_type,vpd.grant_amount order by tem.const_ward_name, vsd.cat;",
'corporator_neighbor_tlm':"select tem.const_ward_name, vpd.grant_type, vpd.grant_amount, vpd.grant_amount* sum(vdf.teacher_count) as total_grant from tb_electedrep_master tem,tb_school_electedrep tse, vw_paisa_data vpd, vw_school_dise vsd, vw_dise_facility vdf where tem.id=tse.ward_id and tse.sid=vsd.sid and vdf.dise_id=vsd.dise_code and vpd.criteria='teacher_count' and tem.elec_comm_code in %s  group by tem.const_ward_name, vpd.grant_type, vpd.grant_amount;",
'corporator_neighbor_mntnc':"select tem.const_ward_name, vpd2.grant_type, CASE WHEN mvdf.operator='gt' THEN 'With more than 3 classrooms ' ELSE 'With 3 classrooms or fewer ' END as classroom_count, vpd2.grant_amount * count(distinct tse.sid) as total_grant from (select vdf.dise_id as dise_id, CASE WHEN vdf.classroom_count <= CAST (vpd.factor AS INT) THEN 'lt' ELSE 'gt' END as operator from vw_paisa_data vpd, vw_dise_facility vdf where vpd.criteria='classroom_count') AS mvdf, tb_electedrep_master tem, tb_school_electedrep tse, vw_school_dise vsd, vw_paisa_data vpd2 where tem.id=tse.ward_id and tse.sid = vsd.sid and mvdf.dise_id=vsd.dise_code and mvdf.operator = vpd2.operator and tem.elec_comm_code in %s group by tem.const_ward_name, vpd2.grant_type, mvdf.operator, vpd2.grant_amount order by tem.const_ward_name;",
'corporator_abs_schcount':"select count(distinct tse.sid) from tb_school_electedrep tse where tse.ward_id=%s and tse.heirarchy=1;",
'corporator_abs_preschcount':"select count(distinct tse.sid) from tb_school_electedrep tse where tse.ward_id=%s and tse.heirarchy=2;",
'corporator_fin_schcount':"select count(distinct tse.sid) from vw_school_dise vsd, tb_school_electedrep tse where vsd.sid=tse.sid and tse.ward_id=%s and tse.heirarchy=1;",
'corporator_ang_infra':"select distinct aia.ai_metric, count(distinct aia.sid),aia.ai_group from vw_ang_infra_agg aia, tb_school_electedrep tse where tse.sid=aia.sid and tse.ward_id=%s and aia.perc_score=100 group by aia.ai_metric,aia.ai_group;",
'corporator_infra_count':"select count(distinct aia.sid) from vw_ang_infra_agg aia, tb_school_electedrep tse where tse.sid=aia.sid and tse.ward_id=%s;",
'corporator_dise_facility':"select distinct dfa.df_metric, count(distinct dfa.sid),dfa.df_group from vw_dise_facility_agg dfa, tb_school_electedrep tse where tse.sid=dfa.sid and tse.ward_id=%s and dfa.score=100 group by dfa.df_metric,dfa.df_group;",
'corporator_dise_count':"select count(distinct dfa.sid) from vw_dise_facility_agg dfa, tb_school_electedrep tse where tse.sid=dfa.sid and tse.ward_id=%s;",
'corporator_lib_count':"select count(distinct li.sid) from vw_libinfra li, tb_school_electedrep tse where tse.sid=li.sid and tse.ward_id=%s;",
'corporator_lib_status':"select li.libstatus, count(distinct li.sid) from vw_libinfra li, tb_school_electedrep tse where tse.sid=li.sid and tse.ward_id=%s group by li.libstatus;",
'corporator_lib_summary':"select sum(numbooks) as totalbooks,sum(numracks) as totalracks,sum(numtables) as totaltables ,sum(numchairs) as totalchairs, sum(numcomputers) as totalcomlas,sum(numups) as totalups from vw_libinfra li, tb_school_electedrep tse where tse.sid=li.sid and tse.ward_id=%s;",
'corporator_neighbours_dise':"select distinct tem.const_ward_name, dfa.df_metric, count(distinct dfa.sid),dfa.df_group from vw_dise_facility_agg dfa, tb_school_electedrep tse, tb_electedrep_master tem where tse.sid=dfa.sid and tse.ward_id=tem.id and tem.elec_comm_code in %s and dfa.score=100 group by tem.const_ward_name, dfa.df_metric, dfa.df_group order by tem.const_ward_name,dfa.df_group;",
'corporator_neighbours_anginfra':"select distinct tem.const_ward_name, aia.ai_metric, count(distinct aia.sid), aia.ai_group from vw_ang_infra_agg aia, tb_school_electedrep tse,tb_electedrep_master tem where tse.sid=aia.sid and tse.ward_id=tem.id and tem.elec_comm_code in %s  and aia.perc_score=100 group by tem.const_ward_name, aia.ai_metric,aia.ai_group order by tem.const_ward_name,aia.ai_group;",
'corporator_neighbours_ai_count':"select tem.const_ward_name, count(distinct aia.sid) from vw_ang_infra_agg aia, tb_school_electedrep tse,tb_electedrep_master tem where tse.sid=aia.sid and tse.ward_id=tem.id and tem.elec_comm_code in %s group by tem.const_ward_name;",
'corporator_neighbours_df_count':"select tem.const_ward_name, count(distinct dfa.sid) from vw_dise_facility_agg dfa, tb_school_electedrep tse,tb_electedrep_master tem where tse.sid=dfa.sid and tse.ward_id=tem.id and tem.elec_comm_code in %s group by tem.const_ward_name;"
}
